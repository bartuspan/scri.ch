(function(g,l){function m(b,e){var c=f.getImageData(0,0,d.width,d.height);d.width=b||(g.innerWidth>h?g.innerWidth:h);d.height=e||(g.innerHeight>i?g.innerHeight:i);j.width=c.width;j.height=c.height;copyCtx.putImageData(c,0,0);f.drawImage(j,0,0)}function n(b){if(b.button!==2){var b=o(b),e=b.x,c=b.y,p=e+1,g=c+1;p>h&&(h=p);g>i&&(i=g);f.fillStyle="#000000";f.fillRect(e-1,c-1,2,2);f.beginPath();f.moveTo(b.x,b.y);x();window.addEventListener("mousemove",k,!1);d.addEventListener("touchmove",k,!1)}}function q(){f.stroke();
window.removeEventListener("mousemove",k,!1);d.removeEventListener("touchmove",k,!1)}function x(){if(!r){r=!0;for(var b=[s,t,y],e=function(b){b.stopPropagation()};b.length;){var c=b.shift();c.style.display="block";c.addEventListener("mousedown",e,!1)}}}function k(b){b.preventDefault();var e=o(b),b=e.x,e=e.y,c=b+1,d=e+1;c>h&&(h=c);d>i&&(i=d);f.lineTo(b,e);f.stroke()}function o(b){return{x:b.touches?b.touches[0].pageX:b.pageX,y:b.touches?b.touches[0].pageY:b.pageY}}function u(){g.addEventListener("resize",
function(){m()},!1);m();l.body.addEventListener("touchmove",function(b){b.preventDefault()},!1);d.addEventListener("mousedown",n,!0);d.addEventListener("touchstart",function(b){b.preventDefault();n(b)},!1);window.addEventListener("mouseup",q,!1);d.addEventListener("touchend",q,!1);s.onclick=function(){m(h,i);if(h>0&&i>0)z.value=d.toDataURL("image/png").replace(/^data:image\/png;base64,/,""),A.submit()};t.onclick=function(){window.location=window.SCRICH_URL}}var d=document.getElementById("draw"),s=
document.getElementById("save"),t=document.getElementById("new"),v=document.getElementById("img"),A=document.getElementById("form"),z=document.getElementById("new_draw"),y=document.getElementById("about"),h=0,i=0,r=!1,f=null,j=l.createElement("canvas");copyCtx=null;if(d.getContext){f=d.getContext("2d");copyCtx=j.getContext("2d");l.onselectstart=function(){return!1};var w=window.a=function(b,e){var c=new Image;c.onload=function(){d.width=h=c.width;d.height=i=c.height;try{f.drawImage(c,0,0)}catch(g){window.setTimeout(function(){w(b,
e)},300)}e&&e()};c.src=b};v?w(v.src,u):u()}else g.alert("Your browser does not support canvas, you need to update it before using scri.ch.")})(window,document);
